<!--
  üìÑ drug_history.html ‚Äî –ò—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞

  –≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω:
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –¥–≤–∏–∂–µ–Ω–∏—è (–ø—Ä–∏—Ö–æ–¥/—Ä–∞—Å—Ö–æ–¥) –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –ø—Ä–µ–ø–∞—Ä–∞—Ç—É;
  - –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —Ç–∏–ø—É –¥–≤–∏–∂–µ–Ω–∏—è ("–≤—Å–µ", "—Ç–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥", "—Ç–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥");
  - –î–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel;
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞—Ç–æ–π, —Ç–∏–ø–æ–º, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ–º –ø–æ –∫–∞–∂–¥–æ–º—É –¥–≤–∏–∂–µ–Ω–∏—é;
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ views.drug_history –∏ export_drug_history_excel.
-->

{% extends 'meds/base.html' %}
{% block title %}–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞{% endblock %}
{% block content %}

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ -->
<h2 class="text-2xl font-bold mb-4">–ò—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏—è: {{ drug.name }}</h2>

<!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Excel-—Ñ–∞–π–ª–∞ -->
<div class="mb-6">
  <a href="{% url 'export_drug_history_excel' drug.id %}"
     class="bg-cyan-600 hover:bg-cyan-700 text-white px-4 py-2 rounded shadow text-sm">
    üì• –°–∫–∞—á–∞—Ç—å Excel
  </a>
</div>

<!-- üîç –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –¥–≤–∏–∂–µ–Ω–∏—è: –í—Å–µ / –¢–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥ / –¢–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥ -->
<div class="mb-4 space-x-4 text-sm">
  <span class="text-gray-600">–§–∏–ª—å—Ç—Ä:</span>
  <a href="{% url 'drug_history' drug.id %}"
     class="{% if not active_type %}font-semibold underline{% endif %} text-blue-600">–í—Å–µ</a>
  <a href="?type=in"
     class="{% if active_type == 'in' %}font-semibold underline{% endif %} text-green-600">–¢–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥</a>
  <a href="?type=out"
     class="{% if active_type == 'out' %}font-semibold underline{% endif %} text-red-600">–¢–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥</a>
</div>

<!-- üì§ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–Ω—É –∏–∑ –¥–≤—É—Ö) -->
<a href="{% url 'export_drug_history_excel' drug.id %}"
   class="inline-block mb-6 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded shadow">
  üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
</a>

<!-- –¢–∞–±–ª–∏—Ü–∞ —Å –∑–∞–ø–∏—Å—è–º–∏ –¥–≤–∏–∂–µ–Ω–∏—è -->
<table class="w-full table-auto bg-white shadow rounded-lg">
  <thead>
    <tr class="bg-blue-100">
      <th class="px-4 py-2">–î–∞—Ç–∞</th>
      <th class="px-4 py-2">–¢–∏–ø</th>
      <th class="px-4 py-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
      <th class="px-4 py-2">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
    </tr>
  </thead>
  <tbody>
    {% for move in movements %}
    <tr class="border-t">
      <td class="px-4 py-2">{{ move.date|date:"d.m.Y H:i" }}</td>
      <td class="px-4 py-2">
        {% if move.movement_type == 'in' %}
          <span class="text-green-600">–ü—Ä–∏—Ö–æ–¥</span>
        {% else %}
          <span class="text-red-600">–†–∞—Å—Ö–æ–¥</span>
        {% endif %}
      </td>
      <td class="px-4 py-2">{{ move.quantity }}</td>
      <td class="px-4 py-2">{{ move.note|default:"‚Äî" }}</td>
    </tr>
    {% empty %}
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç -->
    <tr>
      <td colspan="4" class="text-center py-4 text-gray-500">–î–≤–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- –°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Å–ø–∏—Å–∫—É –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ -->
<a href="{% url 'drug_list' %}" class="inline-block mt-6 text-blue-600 underline">
  ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
</a>

{% endblock %}
